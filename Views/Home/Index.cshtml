@{
    ViewData["Title"] = "Start";
    ViewData["FullBleed"] = true;
}
<div class="otd-shell">
    <header class="otd-topbar">
        <div class="otd-brand">
            <div class="otd-brand-menu">
                <button class="otd-brand-trigger" type="button" aria-haspopup="true">
                    <span class="otd-brand-badge">OpenTrainDrive</span>
                </button>
                <div class="otd-dropdown otd-brand-dropdown" role="menu">
                    <button class="otd-dropdown-button" type="button">Oeffnen</button>
                    <button class="otd-dropdown-button" type="button">Speichern</button>
                    <button class="otd-dropdown-button" type="button">Speichern unter</button>
                </div>
            </div>
        </div>
        <nav class="otd-nav" aria-label="Hauptnavigation">
            <div class="otd-nav-item">
                <button class="otd-nav-trigger" type="button" aria-haspopup="true">System</button>
                <div class="otd-dropdown" role="menu">
                    <a role="menuitem" href="#">Status</a>
                    <a role="menuitem" href="#">Verbindungen</a>
                    <a role="menuitem" href="#">Logs</a>
                    <div class="otd-dropdown-submenu">
                        <button class="otd-dropdown-button otd-submenu-trigger" type="button">Meldeverwalter &gt;</button>
                        <div class="otd-dropdown otd-dropdown-submenu-panel" role="menu">
                            <button class="otd-dropdown-button" type="button" onclick="openMeldeverwalter('horizontal');">Horizontal</button>
                            <button class="otd-dropdown-button" type="button" onclick="openMeldeverwalter('vertical');">Vertikal</button>
                        </div>
                    </div>
                    <form asp-controller="Home" asp-action="Stop" method="post" class="otd-dropdown-form">
                        @Html.AntiForgeryToken()
                        <button class="otd-dropdown-button" type="submit" onclick="return confirm('Moechten Sie die Anwendung und den Server wirklich beenden?');">Beenden</button>
                    </form>
                </div>
            </div>
            <div class="otd-nav-item">
                <button class="otd-nav-trigger" type="button" aria-haspopup="true">ZN/ZL</button>
                <div class="otd-dropdown" role="menu">
                    <a role="menuitem" href="#">Zugnummern</a>
                    <a role="menuitem" href="#">Zuglenkung</a>
                    <a role="menuitem" href="#">Prioritaeten</a>
                </div>
            </div>
            <div class="otd-nav-item">
                <button class="otd-nav-trigger" type="button" aria-haspopup="true">Zugdaten</button>
                <div class="otd-dropdown" role="menu">
                    <a role="menuitem" href="#">Lokomotiven</a>
                    <a role="menuitem" href="#">Wagen</a>
                    <a role="menuitem" href="#">Zuege</a>
                </div>
            </div>
            <div class="otd-nav-item">
                <button class="otd-nav-trigger" type="button" aria-haspopup="true">Gleismelder</button>
                <div class="otd-dropdown" role="menu">
                    <a role="menuitem" href="#">Uebersicht</a>
                    <a role="menuitem" href="#">Stoerungen</a>
                    <a role="menuitem" href="#">Test</a>
                </div>
            </div>
            <div class="otd-nav-item">
                <button class="otd-nav-trigger" type="button" aria-haspopup="true">Uebersichtsbilder</button>
                <div class="otd-dropdown" role="menu">
                    <a role="menuitem" href="#">Bahnhof</a>
                    <a role="menuitem" href="#">Strecke</a>
                    <a role="menuitem" href="#">Knoten</a>
                </div>
            </div>
            <div class="otd-nav-item">
                <button class="otd-nav-trigger" type="button" aria-haspopup="true">Lupenbilder</button>
                <div class="otd-dropdown" role="menu">
                    <a role="menuitem" href="#">Kamerapositionen</a>
                    <a role="menuitem" href="#">Zoom</a>
                    <a role="menuitem" href="#">Archiv</a>
                </div>
            </div>
            <div class="otd-nav-item">
                <button class="otd-nav-trigger" type="button" aria-haspopup="true">RBC</button>
                <div class="otd-dropdown" role="menu">
                    <a role="menuitem" href="#">Status</a>
                    <a role="menuitem" href="#">Telegramme</a>
                    <a role="menuitem" href="#">Verbindungsinfo</a>
                </div>
            </div>
            <div class="otd-nav-item">
                <button class="otd-nav-trigger" type="button" aria-haspopup="true">Konfiguration</button>
                <div class="otd-dropdown" role="menu">
                    <a role="menuitem" href="#">Projekte</a>
                    <a role="menuitem" href="#">Benutzer</a>
                    <a role="menuitem" href="#">Einstellungen</a>
                </div>
            </div>
            <div class="otd-nav-item">
                <button class="otd-nav-trigger" type="button" aria-haspopup="true">?</button>
                <div class="otd-dropdown" role="menu">
                    <a role="menuitem" href="#">Hilfe</a>
                    <a role="menuitem" href="#">Info</a>
                    <a role="menuitem" href="#">Support</a>
                </div>
            </div>
        </nav>
        <div class="otd-status">
            <span class="otd-status-time" id="otd-zeit"></span>
        </div>
    </header>
    <section class="otd-workspace" aria-label="Arbeitsbereich">
        <div class="otd-melde-panel otd-hidden" id="otd-melde-panel" aria-label="Meldeverwalter">
            <div class="otd-melde-titlebar">
                <span class="otd-melde-title">Projektname</span>
                <button class="otd-melde-close-button" type="button" onclick="closeMeldeverwalter();">X</button>
            </div>
            <div class="otd-melde-columns" id="otd-melde-columns">
                <div class="otd-melde-column">
                    <div class="otd-melde-header">Bedienaufforderungen</div>
                    <div class="otd-melde-body" data-section="bedien">
                        <div class="otd-melde-item otd-melde-item-green">Weiche 12 pruefen</div>
                        <div class="otd-melde-item otd-melde-item-green">Bahnuebergang quittieren</div>
                    </div>
                </div>
                <div class="otd-melde-column">
                    <div class="otd-melde-header">Betriebsmeldungen</div>
                    <div class="otd-melde-body" data-section="betrieb">
                        <div class="otd-melde-item otd-melde-item-blue">Zug 4711 abgefahren</div>
                        <div class="otd-melde-item otd-melde-item-blue">Signal S5 auf Fahrt</div>
                    </div>
                </div>
                <div class="otd-melde-column">
                    <div class="otd-melde-header">Stoerungen</div>
                    <div class="otd-melde-body" data-section="stoerung">
                        <div class="otd-melde-item otd-melde-item-red">SCRS W 5 keine Ueberwachung</div>
                        <div class="otd-melde-item otd-melde-item-red">SCRS W 5 aufgeschnitten</div>
                    </div>
                </div>
                <div class="otd-melde-column">
                    <div class="otd-melde-header">System</div>
                    <div class="otd-melde-body" data-section="system">
                        <div class="otd-melde-item otd-melde-item-gray">Serverstart abgeschlossen</div>
                        <div class="otd-melde-item otd-melde-item-gray">Projekt Praettigau geladen</div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<script>
    function requestFullscreenOnFirstInteraction() {
        const root = document.documentElement;
        if (!root.requestFullscreen) {
            return;
        }
        const handler = () => {
            root.requestFullscreen().catch(() => { });
            window.removeEventListener('click', handler);
            window.removeEventListener('keydown', handler);
        };
        window.addEventListener('click', handler, { once: true });
        window.addEventListener('keydown', handler, { once: true });
    }

    function updateZeit() {
        const datum = new Date();
        const tag = datum.getDate().toString().padStart(2, '0');
        const monat = (datum.getMonth() + 1).toString().padStart(2, '0');
        const jahr = datum.getFullYear().toString();
        const stunden = datum.getHours().toString().padStart(2, '0');
        const minuten = datum.getMinutes().toString().padStart(2, '0');
        const sekunden = datum.getSeconds().toString().padStart(2, '0');

        const text = `${tag}.${monat}.${jahr} ${stunden}:${minuten}:${sekunden}`;
        document.getElementById('otd-zeit').textContent = text;
    }

    requestFullscreenOnFirstInteraction();
    updateZeit();
    setInterval(updateZeit, 1000);

    function openMeldeverwalter(layout) {
        const panel = document.getElementById('otd-melde-panel');
        const columns = document.getElementById('otd-melde-columns');
        panel.classList.remove('otd-hidden');
        panel.classList.remove('otd-melde-left');
        columns.classList.remove('otd-melde-vertical');

        if (layout === 'vertical') {
            panel.classList.add('otd-melde-left');
            columns.classList.add('otd-melde-vertical');
        }
    }

    function closeMeldeverwalter() {
        const panel = document.getElementById('otd-melde-panel');
        panel.classList.add('otd-hidden');
    }

    document.addEventListener('click', (event) => {
        const item = event.target.closest('.otd-melde-item');
        if (!item) {
            return;
        }
        const body = item.closest('.otd-melde-body');
        const section = body?.getAttribute('data-section');
        if (section === 'system') {
            item.remove();
            return;
        }
        item.classList.remove(
            'otd-melde-item-green',
            'otd-melde-item-blue',
            'otd-melde-item-red',
            'otd-melde-item-gray'
        );
        item.classList.add('otd-melde-item-ack');
    });
</script>
